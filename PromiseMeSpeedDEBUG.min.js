'use strict';(function(L){function D(c){c()}function E(c){c(this)}function G(){if(u){do q=!1,A.shift()();while(--u)}q=!1}function J(c){return function(l){try{"function"===typeof l&&l()}catch(e){return p(e)}return c}}function t(c){function l(a){0===f&&(F(a)?a.then(l,e):(h=a,f=2,null!==b&&("function"===typeof b?b(a):b.forEach(E,a),b=null),d=null,null!==k&&("function"===typeof k?k():k.forEach(D),k=null)))}function e(a){0===f&&(h=a,f=1,null!==d&&("function"===typeof d?d(a):d.forEach(E,a),d=null),b=null,
null!==k&&("function"===typeof k?k():k.forEach(D),k=null))}var h,f=0,b=null,d=null,k=null,g={then:function(a,m){void 0!=a&&"function"!==typeof a&&console.warn(Object.prototype.toString.call(a)+" is not a valid function to be called after a successful promise");void 0!=m&&"function"!==typeof m&&console.warn(Object.prototype.toString.call(m)+" is not a valid function to be called after a rejected promise");if(0===f)return H(function(v,y){var w="function"===typeof a?function(){v(a(h))}:v,I="function"===
typeof m?function(){y(m(h))}:y;null!==b?"function"===typeof b?b=[b,w]:b.push(w):b=w;null!==d?"function"===typeof d?d=[d,I]:d.push(I):d=I});try{return 2===f?"function"===typeof a?B(a(h)):r:"function"===typeof m?p(m(h)):r}catch(v){return p(v)}},"catch":function(a){void 0!=a&&"function"!==typeof a&&console.warn(Object.prototype.toString.call(a)+" is not a valid function to be called after a rejected promise");if(0===f)return H(function(m){null!==d?"function"===typeof d?d=[d,function(){m(a(h))}]:d.push(function(){m(a(h))}):
d=function(){m(a(h))};null!==b?"function"===typeof b?b=[b,m]:b.push(m):b=m});if(2===f)return B(h);try{return"function"===typeof a?B(a(h)):r}catch(m){return p(m)}},"finally":function(a){void 0!=a&&"function"!==typeof a&&console.warn(Object.prototype.toString.call(a)+" is not a valid function to be called 'finally' after promise");if(0===f)null!==k?"function"===typeof k?k=[k,a]:k.push(a):k=a;else try{a()}catch(m){return p(m)}return g}};!0===C&&(g[z]="Promise");if(!0===q)A.push(function(){try{c(l,e)}catch(a){e(a)}}),
u=u+1|0;else{n=n+1|0;if(q=128===n)try{c(l,e)}catch(a){e(a)}else{try{c(l,e)}catch(a){e(a)}!0===q&&1===n&&G()}n=n-1|0}return g}function H(c){function l(g){0===h&&(e=g,h=1,null!==b&&("function"===typeof b?b(g):b.forEach(E,g),b=null),f=null,null!==d&&("function"===typeof d?d():d.forEach(D),d=null))}var e,h=0,f=null,b=null,d=null,k={then:function(g,a){g&&"function"!==typeof g&&console.error(Object.prototype.toString.call(g)+" is not a valid function to be called after a successful promise");a&&"function"!==
typeof a&&console.error(Object.prototype.toString.call(a)+" is not a valid function to be called after a rejected promise");if(0===h)return t(function(m,v){var y="function"===typeof g?function(){m(g(e))}:m,w="function"===typeof a?function(){v(a(e))}:v;null!==f?"function"===typeof f?f=[f,y]:f.push(y):f=y;null!==b?"function"===typeof b?b=[b,w]:b.push(w):b=w});try{return 2===h?"function"===typeof g?x(g(e)):r:"function"===typeof a?p(a(e)):r}catch(m){return p(m)}},"catch":function(g){g&&"function"!==typeof g&&
console.error(Object.prototype.toString.call(g)+" is not a valid function to be called after a rejected promise");if(0===h)return t(function(a){null!==b?"function"===typeof b?b=[b,function(){a(g(e))}]:b.push(function(){a(g(e))}):b=function(){a(g(e))};null!==f?"function"===typeof f?f=[f,a]:f.push(a):f=a});if(2===h)return x(e);try{return"function"===typeof g?x(g(e)):r}catch(a){return p(a)}},"finally":function(g){"function"!==typeof g&&console.error(Object.prototype.toString.call(g)+" is not a valid function to be called 'finally' after promise");
0===h?null!==d?"function"===typeof d?d=[d,g]:d.push(g):d=g:g();return k}};!0===C&&(k[z]="Promise");try{c(function m(a){0===h&&(F(a)?a.then(m,l):(e=a,h=2,null!==f&&("function"===typeof f?f(a):f.forEach(E,a),f=null),null!==d&&("function"===typeof d?d():d.forEach(D),d=null),b=null))},l)}catch(g){l(g)}return k}function x(c){if("object"===typeof c&&null!==c&&"function"===typeof c.then)return c;var l={then:function(e){if("function"!==typeof e)return l;if(!0===q)return H(function(f,b){A.push(function(){try{f(e(c))}catch(d){b(d)}});
u=u+1|0});n=n+1|0;var h=null;try{(q=128===n)?A.push(function(){e(c)}):(h=e(c),!0===q&&1===n&&G())}catch(f){return p(f)}finally{n=n-1|0}return B(h)},"catch":function(){return l},"finally":function(e){if("function"===typeof e)if(!0===q)A.push(e),u=u+1|0;else{n=n+1|0;try{(q=128===n)?(e(),q=!1):(e(),!0===q&&1===n&&G())}catch(h){return p(h)}finally{n=n-1|0}}return l}};!0===C&&(l[z]="Promise");return l}function B(c){if("object"===typeof c&&null!==c&&"function"===typeof c.then)return c;var l={then:function(e,
h){try{return"function"===typeof h?x(e(c)):r}catch(f){return p(f)}},"finally":J(l),"catch":function(){return l}};!0===C&&(l[z]="Promise");return l}function p(c){var l={then:function(e,h){try{return"function"===typeof h?x(h(c)):r}catch(f){return p(f)}},"finally":J(l),"catch":function(e){try{return"function"===typeof e?x(e(c)):r}catch(h){return p(h)}}};!0===C&&(l[z]="Promise");return l}const A=[],F=t.isPromise=function(c){return"object"===typeof c&&null!==c&&"function"===typeof c.then};var n=0,q=!1,
u=0,z="undefined"!==typeof Symbol&&Symbol.toStringTag,C="symbol"===typeof z,r=x();t.resolve=B;t.reject=p;var K=!1;t.race=function(c){if(!c||!c.forEach)return console.error(Object.prototype.toString.call(c)+" is not a valid iterable array of promises. If you are using an array-like object, then you must call Array.prototype.slice.call on the object before passing it to SPromise.race."),r;K||c.length||(K=!0,console.warn(Object.prototype.toString.call(c)+" is an empty array of promises passed to SPromise"));
return t(function(l,e){function h(g){b&&(b=0,l(g))}function f(g){b&&(b=0,e(g))}for(var b=1,d=0,k;d<c.length&&b;d=d+1|0)F(k=c[d])?k.then(h,f):h(k)})};t.all=function(c){return c&&c.forEach?t(function(l,e){function h(a){g.then(function(m){d[a]=m;b=b-1|0;0===b&&l(d)},function(m){0<b&&(b=-1,e(m))})}for(var f=c.length|0,b=f,d=[],k=0,g;k<f;k=k+1|0)d[k]=F(g=c[k])?h(k):g}):(console.error(Object.prototype.toString.call(c)+" is not a valid iterable array of promises. If you are using an array-like object, then you must call Array.prototype.slice.call on the object before passing it to SPromise.all."),
r)};L.SPromise=t})("undefined"===typeof self?this:self);//AnonyCo
