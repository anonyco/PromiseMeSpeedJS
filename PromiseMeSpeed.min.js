(function(){function q(a){a()}function r(a){a(this)}function f(p){function n(a){g=null;h=a;c=!0;null!==d&&(d.forEach(r,a),d=null);null!==l&&(l.forEach(q),l=null);g=null}function k(a){d=null;h=a;c=!1;null!==g&&(g.forEach(r,a),g=null);null!==l&&(l.forEach(q),l=null);g=d=l=null}var h,c,d=null,g=null,l=null;if(a)m.push(p.bind(void 0,n,k)),e++;else if(256===b)a=!0,p(n,k);else{++b;p(n,k);if(1===b){if(e){do a=!1,m.shift()();while(--e)}a=!1}--b}return{then:function(a,b){return f(function(k,e){void 0===c?
(a&&(null!==d?d.push(a):d=[a]),b&&(null!==g?g.push(b):g=[b])):!0===c?a&&k(a(h)):b&&e(b(h))})},catch:function(a){a&&(null!==g?g.push(a):g=[a]);return f(function(b,d){void 0===c?a&&g.push(function(){return d(a(h))}):a&&d(a(h))})},finally:function(a){void 0===c?l?l.push(a):l=[a]:a()}}}var m=[],t=window.Promise||Object.create(null);f.isPromise=function(a){return!!a&&(a.constructor===f||a.constructor===t)};var b=0,a=!1,e=0;f.resolve=function k(n){var h={then:function(c){if(a)return f(function(a){m.push(function(){a(c(n))});
e++});if(256===b){a=!0;var d=c(n)}else{++b;d=c(n);if(1===b){if(e){do a=!1,m.shift()();while(--e)}a=!1}--b}return k(d)},finally:function(c){if(a)m.push(c),e++;else if(256===b)a=!0,c();else{++b;c();if(1===b&&a){do a=!1,m.shift()();while(--e);a=!1}--b}return h},catch:function(){return h}};return h};f.reject=function h(k){var c={then:function(){return c},finally:function(d){if(a)m.push(d),e++;else if(256===b)a=!0,d();else{++b;d();if(1===b){if(e){do a=!1,m.shift()();while(--e)}a=!1}--b}return c},
catch:function(d){if(a)return f(function(a){m.push(function(){a(d(k))});e++});if(256===b){a=!0;var c=d(k)}else{++b;c=d(k);if(1===b){if(e){do a=!1,m.shift()();while(--e)}a=!1}--b}return h(c)}};return c};f.race=function(a){return f(function(b){var c=!1;a.forEach(function(a){a.then(function(a){!1===c&&(c=!0,b(a),console.warn)})})})};f.all=function(a){return f(function(b){var c=a.length;a.forEach(function(a){a.then(function(a){--c||b(a)})})})};window.SPromise=f})();